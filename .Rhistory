rm(list=ls())
options(stringsAsFactors = FALSE)
options(mc.cores = parallel::detectCores())
graphics.off()
setwd("~/Documents/git/bioticHogs/")
library(brms)
library(dplyr)
c<-read.csv("Data/FULLDatabase_10272022_diversity_PctCov_100_10272022_INHABIT.csv")
colnames(c)
clims<-c %>% group_by(NA_L1NAME) %>% summarise(mean(ETa_Jun_Aug_2003_2018.tif))
View(clims)
clims<-c %>% group_by(NA_L1NAME) %>% summarise(mean(PPT_ETo_Jun_Aug_1981_2018.tif))
View(clims)
clims<-c %>% group_by(NA_L1NAME) %>%
summarise(mean(PPT_ETo_Jun_Aug_1981_2018.tif),sd(PPT_ETo_Jun_Aug_1981_2018.tif))
View(clims)
clims<-c %>% group_by(NA_L1NAME) %>%
summarise(mean(PPT_ETo_Apr_Oct_1981_2018_mean.tif),sd(PPT_ETo_Apr_Oct_1981_2018_mean.tif))
View(clims)
clims<-c %>% group_by(NA_L1NAME) %>%
summarise(mean(PPT_ETo_Apr_Oct_1981_2018_mean.tif,na.rm=TRUE),sd(PPT_ETo_Apr_Oct_1981_2018_mean.tif,na.rm=TRUE))
View(clims)
View(clims)
clims<-c %>% group_by(NA_L1NAME) %>%
summarise(mean=mean(PPT_ETo_Apr_Oct_1981_2018_mean.tif,na.rm=TRUE),sd=sd(PPT_ETo_Apr_Oct_1981_2018_mean.tif,na.rm=TRUE))
ggplot(clims,aes(mean,NA_L1NAME))+geom_bar()
library(ggplot2)
ggplot(clims,aes(mean,NA_L1NAME))+geom_bar()
ggplot(clims,aes(mean,NA_L1NAME))+geom_bar(stat='identity')
clims<-filter(clims,!is.na(NA_L1NAME))
ggplot(clims,aes(mean,NA_L1NAME))+geom_bar(stat='identity')
ggplot(clims,aes(mean,reorder(NA_L1NAME,mean)))+geom_bar(stat='identity')
ggplot(clims,aes(mean,-reorder(NA_L1NAME,mean)))+geom_bar(stat='identity')
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity')
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity')+geom_errorbarh(aes(xmin=mean-sd,max=mean+sd))
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd))
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',color='black')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='black')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black'')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black'')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+ggthemes::theme_few()
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+
geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+
ggthemes::theme_few()+geom_vline(xintercept=0,linetype="dashed")
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+
geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+
ggthemes::theme_few()+geom_vline(xintercept=0)
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+
geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+
ggthemes::theme_few()+geom_vline(xintercept=0,color='blue')
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+
geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+
ggthemes::theme_few()+geom_vline(xintercept=0,color='blue')+ylab("")+xlab("Potential Water Deficit \nApril-October")
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='white',color='black')+
geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+
ggthemes::theme_few()+geom_vline(xintercept=0,color='blue')+ylab("")+xlab("potential water deficit \nApril-October")
ggplot(clims,aes(mean,reorder(NA_L1NAME,-mean)))+geom_bar(stat='identity',fill='black',color='black')+
geom_errorbarh(aes(xmin=mean-sd,xmax=mean+sd),height=.1)+
ggthemes::theme_few()+geom_vline(xintercept=0,color='blue')+ylab("")+xlab("potential water deficit \nApril-October")
rm(list=ls())
options(stringsAsFactors = FALSE)
options(mc.cores = parallel::detectCores())
graphics.off()
setwd("~/Documents/git/bioticHogs/")
library(brms)
library(dplyr)
library(rgbif)
occ_search(scientificName = "Chevreulia acuminata")
d<-occ_search(scientificName = "Chevreulia acuminata")
View(d)
d[1]
d[2]
d[3]
d<-as.data.frame(d[3])
View(d)
d<-occ_search(scientificName = "Chevreulia acuminata",hasGeospatialIssue = FALSE)
d<-as.data.frame(d[3])
View(d)
data.frame(Lat=d$data.decimalLatitude,lon=d$data.decimalLongitude)
d<-data.frame(Lat=d$data.decimalLatitude,lon=d$data.decimalLongitude)
d <- d[complete.cases(d), ]
library(QBMS)
install.packages("QBMS")
library("QBMS")
data <- get_terraclimate(d$lon, d$Lat, '1979-09-01', '2012-06-30')
worldclim_range <- get_terraclimate(d$lon, d$Lat, '1970-01-01', '2000-12-31', c('ppt', 'tmin', 'tmax'))
library(geodata)
library(terra)
wc_data <- worldclim_tile("tmin", coords[1,1], coords[1,2], path = "WorldClimData")
wc_data <- worldclim_tile("tmin", d[1,1], d[1,2], path = "WorldClimData")
points <- vect(coords, geom=c("lon", "lat"), crs = "EPSG:4326")
points <- vect(d), geom=c("lon", "lat"), crs = "EPSG:4326")
points <- vect(d, geom=c("lon", "lat"), crs = "EPSG:4326")
points <- vect(d, geom=c("lon", "Lat"), crs = "EPSG:4326")
extracted_values <- extract(wc_data, points)
View(extracted_values)
worldclim_range <- get_terraclimate(d$lon, d$Lat, '2000-01-01', '2010-12-31', c('ppt', 'tmin', 'tmax'))
worldclim_range <- get_terraclimate(d$lon, d$Lat, '1990-01-01', '2000-12-31', c('ppt', 'tmin', 'tmax'))
View(extracted_values)
worldclim_range <- get_terraclimate(d$lon, d$Lat, '1990-01-01', '2000-12-31', c('ppt', 'tmin', 'tmax'))
worldclim_range <- get_terraclimate(d$lon, d$Lat, '1990-01-01', '2000-12-31', c( 'tmin'))
worldclim_range <- get_terraclimate(d$lon, d$Lat, '1990-01-01', '2000-12-31', c( 'tmin'))
worldclim_norm  <- apply(worldclim_range$biovars[[2]][,1:19], 2, function(x) round(mean(x), 1))
worldclim_norm  <- apply(worldclim_range$biovars[[2]][,1:19], 2, function(x) round(mean(x), 1))
worldclim_norm  <- apply(worldclim_range$biovars[[1]][,1:19], 2, function(x) round(mean(x), 1))
worldclim_norm  <- apply(worldclim_range$biovars[,1:19], 2, function(x) round(mean(x), 1))
View(worldclim_range)
View(worldclim_range)
worldclim_norm  <- apply(worldclim_range$biovars[[218]][,1:19], 2, function(x) round(mean(x), 1))
worldclim_norm  <- apply(worldclim_range$biovars[[1]][,1:19], 2, function(x) round(mean(x), 1))
View(worldclim_range)
worldclim_norm  <- apply(worldclim_range$biovars[[1]][218,1:19], 2, function(x) round(mean(x), 1))
worldclim_norm  <- apply(worldclim_range$biovars[218,1:19], 2, function(x) round(mean(x), 1))
View(worldclim_range)
worldclim_range$climate
worldclim_range$climate[[1]]
head(worldclim_range$climate[[1]])
head(worldclim_range$climate[[1]],20)
View(worldclim_range)
worldclim_norm  <- apply(worldclim_range$climate[1:218], 2, function(x) round(mean(x)
)
worldclim_norm  <- apply(worldclim_range$climate[1:218], 2, function(x) round(mean(x))
worldclim_norm  <- apply(worldclim_range$climate[1:218], 2, function(x) round(mean(x)))
worldclim_norm  <- apply(worldclim_range$climate[1:218], 2, function(x) round(mean(x)))
worldclim_norm  <- apply(worldclim_range$climate[[]], 2, function(x) round(mean(x)))
View(worldclim_range)
worldclim_norm  <- apply(worldclim_range$climate[[1;218]], 2, function(x) round(mean(x)))
averages <- sapply(worldclim_range$climate mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate, mean, na.rm = TRUE)
averages
View(worldclim_range)
averages <- sapply(worldclim_range$climate$tmin, mean, na.rm = TRUE)
View(averages)
averages <- sapply(worldclim_range$climate$[3], mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate[3], mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate[,3], mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate[3,], mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate[3,], mean, na.rm = TRUE)
averages <- sapply(worldclim_range$climate[[3,]], mean, na.rm = TRUE)
tmin_averages <- sapply(worldclim_range, function(x) mean(x$tmin, na.rm = TRUE))
View(worldclim_range)
str(worldclim_range[[1]])
tmin_averages <- sapply(worldclim_range, function(df) mean(df$tmin, na.rm = TRUE))
tmin_averages <- sapply(worldclim_range, function(df) mean(df$tmin, na.rm = TRUE))
tmin_averages
tmin_averages <- sapply(worldclim_range$climate, function(df) mean(df$tmin, na.rm = TRUE))
tmin_df <- data.frame(
ID = seq_along(tmin_averages),
Average_Tmin = tmin_averages
)
View(tmin_df)
View(d)
rbind(d,tmin_df)
cbind(d,tmin_df)
goo<-cbind(d,tmin_df)
View(goo)
View(worldclim_range)
View(extracted_values)
View(worldclim_range)
worldclim_range[["climate"]][[2]][["tmin"]]
