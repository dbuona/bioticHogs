ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
facet_grdid(domers~cover_diff)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
facet_grid(domers~cover_diff)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_few()+
facet_grid(domers~cover_diff)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_ggdist()+
facet_grid(domers~cover_diff)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_grid(domers~cover_diff)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_wrap(~domers)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3a<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_wrap(~domers)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3c<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_grid(domers~cover_diff)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot(p3a,p3b,p3c,ncol=1)
ggpubr::ggarrange(p3a,p3b,p3c,ncol=1)
View(brforsmalz)
brforsmalz$plotscale<-ifelse(brforsmalz$plot_distances>=median(brforsmalz$plot_distances),"far","close")
p4b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_wrap(~plotscale)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p4b
p4c<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_grid(plotscale~domers)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p4c
ggpubr::ggarrange(p3a,p3b,p3c,p4b,p4c,ncol=1)
pstage<-ggpubr::ggarrange(p3b,p3c)
pstage
pstage
pstage<-ggpubr::ggarrange(p3b,p3c,ncol=1)
pstage<-ggpubr::ggarrange(p3b,p3c,p4b,p4c,ncol=2)
pstage
pstage<-ggpubr::ggarrange(p3b,p3c,p4b,p4c,ncol=2,nrow=2)
pstage
pstage<-ggpubr::ggarrange(p3b,p4b,p3c,p4c,ncol=2,nrow=2)
pstage
pstage
ggpubr::ggarrange(p3a,pstage,ncol=1)
ggpubr::ggarrange(p3a,p3b,pstage,ncol=1)
ggpubr::ggarrange(p3a,p3b,pstage,ncol=1)
pstage<-ggpubr::ggarrange(p3c,vplot,ncol=2,nrow=2)
pstage<-ggpubr::ggarrange(p3c,vplot,ncol=2)
ggpubr::ggarrange(p3a,p3b,pstage,ncol=1)
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_wrap(~domers,ncol=1)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=1)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+coord_cartesian(ylim=c(0,.30))+
xlab("invader abundance")+ylab("predicted likelihood")
pstage<-ggpubr::ggarrange(p3c,vplot,ncol=2)
ggpubr::ggarrange(p3a,p3b,pstage,ncol=1)
pstage<-ggpubr::ggarrange(p3b,vplot,ncol=2)
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
dylly<-epred_draws(test.mod5,newdata = dully,ndraws=1000,re_formula = ~NULL)
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=1)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+coord_cartesian(ylim=c(0,.30))+
xlab("invader abundance")+ylab("predicted likelihood")
fakeo<-data.frame(domers=rep(c("mono-specific","hetero-specific"),2),logdist=rep(c(0,6),each=2))
dolly<-epred_draws(test.mod6,newdata = fakeo,ndraws=1000,re_formula = ~NULL)
#dolly<-filter(dolly,.category %in% c(2,4))
dolly$grouper<-paste(dolly$.draw,dolly$domers)
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+facet_wrap(~.category)+coord_cartesian(ylim=c(0,.30))+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+xlab("distance \nlog(km)")+ylab("predicted likelihood")
vplot
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+facet_wrap(~.category)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+xlab("distance \nlog(km)")+ylab("predicted likelihood")
vplot
facet_wrap(~factor(.category, levels=c('2','1','3','4'))+
vplot
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
vplot
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+
facet_wrap(~factor(.category, levels=c(2,1,3,4)))+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+xlab("distance \nlog(km)")+ylab("predicted likelihood")
vplot
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+
facet_wrap(~factor(.category, levels=c(2,1,3,4)))+theme(legend.position = "top")+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+xlab("distance \nlog(km)")+ylab("predicted likelihood")
pstage<-ggpubr::ggarrange(p3b,vplot,ncol=2)
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
vplot
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+
facet_wrap(~factor(.category, levels=c(2,1,3,4)))+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+xlab("distance \nlog(km)")+ylab("predicted likelihood")+theme(legend.position = "top")
pstage<-ggpubr::ggarrange(p3b,vplot,ncol=2)
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
pdf(file = "Analyses/AbnOcc/figure4.pdf",width =7,height = 8 )
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
dev.off()
pstage<-ggpubr::ggarrange(p3b,vplot,ncol=2)
pdf(file = "Analyses/AbnOcc/figure4.pdf",width =7,height =9 )
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
dev.off()
pdf(file = "Analyses/AbnOcc/figure4.pdf",width =8,height =10 )
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
dev.off()
dooly<-cbind(dully,fitted(test.mod5,newdata = dully,re_formula = ~NULL))
View(dooly)
test.base<-brms::brm(quad~1+(1|mm(site1,site2)),data=brforsmalz,family=categorical(link="logit"))
fitted(test.base)
fitted(test.base,re_formula = ~NULL)
brms::fitted(test.base,re_formula = ~NULL)
tidybayes::fitted(test.base,re_formula = ~NULL)
fitted(test.base,re_formula = ~NULL)
sumz<-fitted(test.base,re_formula = ~NULL)
sumz<-fitted(test.base,re_formula = ~NULL,summary = TRUE)
test.base
summary(test.base)
test.base<-brms::brm(quad~(1|mm(site1,site2)),data=brforsmalz,family=categorical(link="logit"))
test.base
sumz<-fitted(test.base,re_formula = ~NULL,summary = TRUE)
sumz
sumz<-fitted(test.base,re_formula = ~NULL,summary = TRUE,ndraws = 100)
sumz
sumz<-as.data.frame(fitted(test.base,re_formula = ~NULL,summary = TRUE,ndraws = 100))
View(sumz)
sumz<-distinc(sumz)
sumz<-distinct(sumz)
View(sumz)
sumz<-round(sumz,3)
View(sumz)
sumz
test.mod3
test.mod3<-brms::brm(quad~domers+(1|mm(site1,site2)),data=brforsmalz,family=categorical(link="logit"))
conditional_effects(test.mod3,categorical=TRUE)
test.mod4
conditional_effects(test.mod4,categorical=TRUE)
conditional_effects(test.mod5,categorical=TRUE)
vvplot
ggpubr::ggarrange(vvplot,vplot,ncol=1,common.legend=TRUE)
ggpubr::ggarrange(p3a,pstage,p3c,ncol=1)
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=1)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+coord_cartesian(ylim=c(0,.30))+
xlab("invader abundance")+ylab("predicted likelihood")
vvplot
vplot
p3a
pstage
p3b
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
facet_wrap(~domers,ncol=2)+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggpubr::ggarrange(p3a,p3b,p3c,ncol=1)
ggpubr::ggarrange(p3a,p3b,vplot,ncol=1)
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A,color=domers),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3b
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A,color=domers),size=0.01)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3b
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A,color=domers),size=0.1)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3b
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A,color=domers),size=1)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3b
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A,color=domers),size=.1)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
p3b
ggpubr::ggarrange(p3b,vplot,ncol=1)
ggpubr::ggarrange(p3b,vplot,ncol=1,common.legend = TRUE)
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=1)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+coord_cartesian(ylim=c(0,.30))+
xlab("invader abundance")+ylab("predicted likelihood")
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=1)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
xlab("invader abundance")+ylab("predicted likelihood")
vvplot
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=2)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
xlab("invader abundance")+ylab("predicted likelihood")
vvplot
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+facet_wrap(~.category,ncol=2,scales = "free_y")+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
xlab("invader abundance")+ylab("predicted likelihood")
vvplot
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+
facet_wrap(~factor(.category, levels=c(2,1,3,4)),ncol=2,scales = "free_y")+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
xlab("invader abundance")+ylab("predicted likelihood")
vvplot
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+
facet_wrap(~factor(.category, levels=c(2,1,3,4)),ncol=2)+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+
xlab("invader abundance")+ylab("predicted likelihood")
vvplot
ggpubr::ggarrange(p3b,vplot,vvplot,ncol=1,common.legend = TRUE)
ggpubr::ggarrange(vplot,vvplot,ncol=1,common.legend = TRUE)
ggpubr::ggarrange(vplot,vvplot,ncol=2,common.legend = TRUE)
pstage<-ggpubr::ggarrange(vplot,vvplot,ncol=2,common.legend = TRUE)
ggpubr::ggarrange(p3b,pstage,common.legend = TRUE)
ggpubr::ggarrange(p3b,pstage,common.legend = TRUE,ncol=1)
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+
facet_wrap(~factor(.category, levels=c(2,1,3,4)))+
ggthemes::theme_few()+scale_color_manual(values=(c("royalblue1","navy")))+xlab("distance log(km)")+ylab("predicted likelihood")+theme(legend.position = "top")
pstage<-ggpubr::ggarrange(vvplot,vplot,ncol=2,common.legend = TRUE)
ggpubr::ggarrange(p3b,pstage,common.legend = TRUE,ncol=1)
pdf(file = "Analyses/AbnOcc/figure4.pdf",width =8,height =10 )
ggpubr::ggarrange(p3b,pstage,common.legend = TRUE,ncol=1)
dev.off()
p3b<-ggplot()+
geom_point(data=brforsmalz,aes(x=H.O,y=H.A,color=domers),size=.1)+
#geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
ggthemes::theme_few()+scale_color_manual(values=(c("lightblue1","navy")))+
#scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
#dylly<-filter(dylly,.category %in% c(2,4))
vvplot<-ggplot(dylly,aes(reorder(cover_diff,-.epred),.epred))+stat_pointinterval(aes(color=domers),.width=c(.5,.95))+
facet_wrap(~factor(.category, levels=c(2,1,3,4)),ncol=2)+
ggthemes::theme_few()+scale_color_manual(values=(c("lightblue1","navy")))+
xlab("invader abundance")+ylab("predicted likelihood")
vplot<-ggplot(dolly,aes(logdist,.epred))+geom_line(aes(color=domers,group=grouper),size=0.004)+
geom_smooth(aes(color=domers),method="glm")+
facet_wrap(~factor(.category, levels=c(2,1,3,4)))+
ggthemes::theme_few()+scale_color_manual(values=(c("lightblue1","navy")))+xlab("distance log(km)")+ylab("predicted likelihood")+theme(legend.position = "top")
pstage<-ggpubr::ggarrange(vvplot,vplot,ncol=2,common.legend = TRUE)
ggpubr::ggarrange(p3b,pstage,common.legend = TRUE,ncol=1)
pdf(file = "Analyses/AbnOcc/figure4.pdf",width =8,height =10 )
ggpubr::ggarrange(p3b,pstage,common.legend = TRUE,ncol=1)
dev.off()
sumz
sumzer,fitted(test.mod3)
sumzer<-fitted(test.mod3)
sumzer<-distinct(sumzer)
sumzer<-as.data.frame(fitted(test.mod3,summary=TRUE,ndraws=2))
View(sumzer)
faker<-data.frame(domers=unique(envgoo$domers))
sumzer<-as.data.frame(fitted(test.mod3,newdata=faker,summary=TRUE,re_formula = ~NULL))
View(sumzer)
sumzer<-as.data.frame(cbind(faker,fitted(test.mod3,newdata=faker,summary=TRUE,re_formula = ~NULL)))
View(sumzer)
sumzer<-round(sumzer,3)
sumzer<-as.data.frame(fitted(test.mod3,newdata=faker,summary=TRUE,re_formula = ~NULL))
sumzer<-round(sumzer,3)
sumzer<-cbind(faker,sumzer)
View(sumzer)
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
jpeg("Analyses/AbnOcc/heatmap.jpeg",width=8,height=8,units = 'in',res=300)
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "Purples",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
dev.off()
#jpeg("Analyses/AbnOcc/heatmap.jpeg",width=8,height=8,units = 'in',res=300)
pdf("Analyses/AbnOcc/heatmap.pdf",width=8,height=8)
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "Purples",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
dev.off()
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "Blues",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "Blues",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
dev.off()
jpeg("Analyses/AbnOcc/heatmap.jpeg",width=8,height=8,units = 'in',res=300)
#pdf("Analyses/AbnOcc/heatmap.pdf",width=8,height=8)
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "Blues",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
#geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
dev.off()
42.4+34.8
round(table(env$number)[2]/(table(env$number)[1]+table(env$number)[2]),2)
round(mean(env$dif,na.rm=TRUE),3)
round(sd(env$dif,na.rm=TRUE),3)
ggplot()+
geom_point(data=env,aes(x=H.O,y=H.A),size=0.01)+
geom_tile(data=heat.test,aes(x=H.O,y=H.A,fill=frequency),alpha=.8)+
tidybayes::theme_tidybayes()+
scale_fill_distiller(palette = "PuRd",direction=1 )+
geom_hline(yintercept=0,color="darkgray")+geom_vline(xintercept=0,color="darkgray")+
ylab("abundance")+xlab("occurence")+
geom_text(data=heat.test,aes(x=H.O,y=H.A,label=frequency3),size=2,color="navy")+
#geom_smooth(method="lm",color="yellow")
geom_abline(slope = 1,intercept = 0,color="black",linetype="dotdash",size=1)
100-77.2
range(d$Year)
View(brD)
View(doop)
